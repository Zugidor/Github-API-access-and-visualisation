<!DOCTYPE html>
<meta charset="utf-8">
<html lang="en"></html>

<!-- load d3.js -->
<script src=https://d3js.org/d3.v4.js></script>

<!-- create divs for graphs -->
<div id="graph1"></div>
<div id="graph2"></div>

<script>
    // set dimensions and margins for graphs
    const margin1 = {top: 40, right: 20, bottom: 150, left: 40},
        width1 = 1300 - margin1.left - margin1.right,
        height1 = 650 - margin1.top - margin1.bottom;

    const margin2 = {top: 40, right: 20, bottom: 100, left: 40},
        width2 = 1300 - margin2.left - margin2.right,
        height2 = 650 - margin2.top - margin2.bottom;

    // append svg objects to the body of the page
    const svg1 = d3.select("#graph1")
        .append("svg")
            .attr("width", width1 + margin1.left + margin1.right)
            .attr("height", height1 + margin1.top + margin1.bottom)
        .append("g")
            .attr("transform",
                "translate(" + margin1.left + "," + margin1.top + ")")
    
    const svg2 = d3.select("#graph2")
    .append("svg")
            .attr("width", width2 + margin2.left + margin2.right)
            .attr("height", height2 + margin2.top + margin2.bottom)
        .append("g")
            .attr("transform",
                "translate(" + margin2.left + "," + margin2.top + ")");
    
    // parse csv data for regions
    d3.csv("http://localhost:8000/regions.csv", function(data) {
        // X axis
        const x = d3.scaleBand()
            .range([0, width1])
            .domain(data.map(function(d) { return d.Region; }))
            .padding(0.2);
        svg1.append("g")
            .attr("transform", "translate(0," + height1 + ")")
            .call(d3.axisBottom(x))
            .selectAll("text")
                .attr("font-weight", "bold")
                .attr("font-size", "14px")
                .attr("transform", "translate(-10,0)rotate(-35)")
                .style("text-anchor", "end");
        svg1.append("text")
            .attr("x", width1 / 2)
            .attr("y", -margin1.top / 2)
            .attr("text-anchor", "middle")
            .attr("fill", "steelblue")
            .style("font-family", "sans-serif")
            .style("font-weight", "bold")
            .style("font-size", "16px")
            .style("text-decoration", "underline")
            .text("Graph counting Followers and Followees by Regional Timezones");
        
        // Y axis
        const y = d3.scaleLinear()
            .domain([0, d3.max(data, function(d) { return +d.Count; })])
            .range([height1, 0]);
        svg1.append("g")
            .call(d3.axisLeft(y));
        
        // append the rectangles for the bar chart
        svg1.selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
                .attr("x", function(d) { return x(d.Region); })
                .attr("y", function(d) { return y(d.Count); })
                .attr("width", x.bandwidth())
                .attr("height", function(d) { return height1 - y(d.Count); })
                .attr("fill", "steelblue");
    });
    
    // parse csv data for UTC
    d3.csv("http://localhost:8000/utc.csv", function(data) {
        // X axis
        const x = d3.scaleBand()
            .range([0, width2])
            .domain(data.map(function(d) { return d.Timezone; }))
            .padding(0.2);
        svg2.append("g")
            .attr("transform", "translate(0," + height2 + ")")
            .call(d3.axisBottom(x))
            .selectAll("text")
                .attr("font-weight", "bold")
                .attr("font-size", "18px")
        svg2.append("text")
            .attr("x", width2 / 2)
            .attr("y", -margin2.top / 2)
            .attr("text-anchor", "middle")
            .attr("fill", "steelblue")
            .style("font-family", "sans-serif")
            .style("font-weight", "bold")
            .style("font-size", "16px")
            .style("text-decoration", "underline")
            .text("Graph counting Followers and Followees by UTC Timezones");
        
        // Y axis
        const y = d3.scaleLinear()
            .domain([0, d3.max(data, function(d) { return +d.Count; })])
            .range([height2, 0]);
        svg2.append("g")
            .call(d3.axisLeft(y));
        
        // append the rectangles for the bar chart
        svg2.selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
                .attr("x", function(d) { return x(d.Timezone); })
                .attr("y", function(d) { return y(d.Count); })
                .attr("width", x.bandwidth())
                .attr("height", function(d) { return height2 - y(d.Count); })
                .attr("fill", "steelblue");
    });
</script>